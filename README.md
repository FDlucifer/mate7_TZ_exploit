# mate7_TZ_exploit
Demo poc for mate7 TEEOS(details TBD)

# Official Security Advisories
http://www.huawei.com/en/security/psirt/security-bulletins/security-advisories/hw-432799.htm

# CVE ID
* CVE-2015-4421
* CVE-2015-4422

# Details
* slides
* white paper

# How to build
ndk-build NDK_DEBUG=1

# Usage

make sure the version of firmware is Mate7-TL10,V100R001CHNC00B123SP03

* ./p1ng  
exploit Linux kernel, exploit TEE_GlobalTask and exploit RTOSck(kernel of TEE).
             Call __FPC_readImage to read fingerprint image.
 
* ./p1ng physical_addr  
dump physical memory from /dev/mem, for debugging only
 
* ./p1ng 0 kernel_addr 
execute TEE shell code at kernel_addr, for debugging only
 
* ./p1ng 0 0 0 0 
read TEE error log from 0x3FE01400(physical addr), for debugging only


# Affected Versions
* Huawei Ascend Mate 7 : Mate7-TL10,V100R001CHNC00B123SP03 or earlier
* TEEOS: TrustedCore Release Version 1.26. Sep 17 2014.13:57:39 or earlier